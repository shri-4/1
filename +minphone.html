
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>강민혁의 휴대폰</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ===== 기본 설정 및 프레임 ===== */
        body { margin: 0; padding: 0; background-color: #333; font-family: 'Noto Sans KR', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        .phone { aspect-ratio: 390 / 844; max-width: 90vw; max-height: 90vh; width: 390px; height: 844px; border: 12px solid black; border-radius: 50px; box-shadow: 0 0 30px rgba(0,0,0,0.5); position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #000; }
        .screen { width: 100%; height: 100%; position: relative; overflow: hidden; background-color: #ffffff; border-radius: 38px; }

        /* ===== 페이지 전환 및 레이아웃 ===== */
        .page { position: absolute; width: 100%; height: 100%; top: 0; left: 0; background-color: #f9f9f9; display: flex; flex-direction: column; transition: opacity 0.2s ease-in-out; visibility: hidden; opacity: 0; z-index: 1; color: #000000; }
        .page.active { visibility: visible; opacity: 1; z-index: 10; }

        /* ===== 공통 UI 요소 ===== */
        .status-bar { text-align: right; padding: 18px 25px 10px 25px; font-size: 14px; font-weight: 700; flex-shrink: 0; color: #000000; background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); z-index: 100; }
        .status-bar.dark-mode { color: #ffffff; background: rgba(0, 0, 0, 0.3); }
        .app-header { display: flex; justify-content: center; align-items: center; padding: 10px 20px; border-bottom: 1px solid #e0e0e0; flex-shrink: 0; font-weight: 700; font-size: 1.1em; background-color: #f8f8f8; position: relative; }
        .app-header .back-button { cursor: pointer; font-size: 1.2em; font-weight: bold; position: absolute; left: 20px; }
        .content-body { flex-grow: 1; overflow-y: auto; background-color: #ffffff; }
        .home-indicator-container { padding: 20px 0 10px 0; display: flex; justify-content: center; align-items: center; flex-shrink: 0; }
        .home-indicator { width: 134px; height: 5px; background-color: #000000; border-radius: 100px; cursor: pointer; }

        /* ===== 잠금 화면 ===== */
        #lock-screen {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            color: white;
            text-shadow: 0 2px 5px rgba(0,0,0,0.5);
            cursor: pointer;
        }
        .lock-screen-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding-bottom: 100px;
        }
        #lock-screen-time {
            font-size: 5.5em;
            font-weight: 300;
        }
        #lock-screen-date {
            font-size: 1.4em;
            font-weight: 500;
            margin-top: 5px;
        }
        .unlock-prompt-container {
            width: 100%;
            padding: 40px 0;
        }
        #unlock-prompt {
            text-align: center;
            font-size: 1.1em;
            font-weight: 500;
            animation: pulse-text 2.5s infinite;
        }
        @keyframes pulse-text {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* ===== 홈 화면 ===== */
        .home-screen { background-size: cover; background-position: center; color: white; }
        .app-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; padding: 20px; flex-grow: 1; align-content: start; }
        .app-icon { display: flex; flex-direction: column; align-items: center; cursor: pointer; text-align: center; }
        .app-icon img { width: 60px; height: 60px; border-radius: 15px; margin-bottom: 5px; }
        .app-icon span { font-size: 12px; color: #fff; text-shadow: 0 1px 3px rgba(0,0,0,0.5); }
        .dock { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 10px 20px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border-radius: 20px; margin: 0 10px 5px 10px; }

        /* ===== 앱별/요소별 커스텀 스타일 ===== */
        .image-placeholder { background-color: #ccc; display: flex; justify-content: center; align-items: center; color: #666; font-size: 12px; text-align: center; padding: 10px; box-sizing: border-box; word-break: keep-all; line-height: 1.3; }
        
        .list-item { padding: 15px 20px; border-bottom: 1px solid #e8e8e8; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        .list-item:hover { background-color: #f0f0f0; }
        .list-item .title { font-weight: bold; }
        .list-item .preview { color: #888; font-size: 0.9em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px; }
        .list-item.missed .title { color: #FF3B30; }

        /* ===== iOS Toggle Switch for Alarms ===== */
        .alarm-toggle { display: flex; align-items: center; }
        .toggle-switch { position: relative; display: inline-block; width: 51px; height: 31px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #E9E9EA; -webkit-transition: .4s; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 27px; width: 27px; left: 2px; bottom: 2px; background-color: white; -webkit-transition: .4s; transition: .4s; border-radius: 50%; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
        input:checked + .slider { background-color: #34C759; }
        input:checked + .slider:before { -webkit-transform: translateX(20px); -ms-transform: translateX(20px); transform: translateX(20px); }

        /* 사진첩 */
        .photo-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 2px; }
        .photo-item { aspect-ratio: 1 / 1; cursor: pointer; }
        .photo-item img { width: 100%; height: 100%; object-fit: cover; }
        .section-title { padding: 10px 20px; background-color: #f0f0f0; font-weight: bold; font-size: 0.9em; }
        .section-title[onclick] { cursor: pointer; }
        
        /* ===== Photo Modal ===== */
        .photo-modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: none; /* Hidden by default */
            justify-content: center;
            align-items: center;
            z-index: 10002;
        }
        .photo-modal-overlay.visible {
            display: flex;
        }
        .photo-modal-content {
            max-width: 100%;
            max-height: 80%;
            object-fit: contain;
        }
        .close-photo-modal {
            position: absolute;
            top: 40px;
            right: 25px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }
        .close-photo-modal:hover,
        .close-photo-modal:focus {
            color: #bbb;
            text-decoration: none;
        }

        /* 미리 알림 */
        .reminder-item {
            display: flex;
            align-items: center;
            width: 100%;
        }
        .reminder-checkbox {
            flex-shrink: 0;
            width: 22px;
            height: 22px;
            border: 2px solid #c8c8c8;
            border-radius: 4px;
            margin-right: 15px;
            position: relative;
        }
        .reminder-checkbox.checked {
            background-color: #a1c4fd; /* 하늘색 */
            border-color: #a1c4fd;
        }
        .reminder-checkbox.checked::after {
            content: "";
            position: absolute;
            left: 7px;
            top: 3px;
            width: 6px;
            height: 12px;
            border: solid white; /* 흰색 체크 */
            border-width: 0 3px 3px 0;
            -webkit-transform: rotate(45deg);
            -ms-transform: rotate(45deg);
            transform: rotate(45deg);
        }

        /* 메시지 */
        .chat-body { display: flex; flex-direction: column; padding: 20px; }
        .message-bubble { padding: 10px 15px; border-radius: 18px; max-width: 75%; margin-bottom: 10px; line-height: 1.4; word-wrap: break-word; }
        .message-bubble.sent { background-color: #007AFF; color: white; align-self: flex-end; }
        .message-bubble.received { background-color: #E5E5EA; color: #000000; align-self: flex-start; }

        /* ===== 캘린더 (레드 & 블랙 테마) ===== */
        #calendar {
            background-color: #000000;
            color: #ffffff;
        }
        #calendar .app-header {
            background-color: #1a1a1a; /* Matte Black */
            color: #ffffff;
            border-bottom: 2px solid #ff3b30; /* Red Accent */
            font-weight: 700;
        }
        #calendar .status-bar {
            color: #ffffff;
            background-color: transparent;
        }
        #calendar .content-body {
            background-color: #000000;
            padding: 10px 10px 0 10px;
        }
        #calendar .day-names {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            color: #aaaaaa;
            font-weight: 500;
            text-align: center;
            font-size: 0.8em;
            padding-bottom: 10px;
        }
        #calendar .day-names div {
            padding: 10px 0;
        }
        #calendar .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: #333333;
        }
        #calendar .calendar-grid .day-cell {
            position: relative;
            background-color: #000000;
            padding: 8px;
            aspect-ratio: 1 / 1;
            font-size: 0.9em;
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            border-radius: 0; /* Sharp corners */
        }
        #calendar .calendar-grid .day-cell.empty {
            background-color: #101010;
        }
        #calendar .date-number {
            font-weight: 500;
            color: #ffffff;
            position: relative;
            z-index: 2;
        }
        #calendar .calendar-grid .day-cell.has-event {
            background-color: #ff3b30; /* Red highlight */
        }
        #calendar .calendar-grid .day-cell.has-event .date-number {
            color: #ffffff;
        }
        #calendar .event-list {
            padding: 10px 20px;
            border-top: 1px solid #333;
            margin-top: 10px;
        }
        #calendar .event-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #222;
        }
        #calendar .event-item:last-child {
            border-bottom: none;
        }
        #calendar .event-date-indicator {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-right: 15px;
            color: #ff3b30; /* Red */
            width: 40px;
        }
        #calendar .event-date-day {
            font-size: 1.5em;
            font-weight: 700;
        }
        #calendar .event-date-weekday {
            font-size: 0.8em;
            font-weight: 500;
            color: #aaa;
        }
        #calendar .event-title {
            font-size: 1em;
            font-weight: 500;
            color: #fff;
        }
        #calendar .calendar-event {
            display: none !important;
        }
        
        /* ===== 사파리 ===== */
        .safari-header {
            padding: 10px 15px;
            background-color: #f8f8f8;
        }
        .search-bar-container {
            display: flex;
            align-items: center;
            background-color: #EFEFF4;
            border-radius: 10px;
        }
        .search-icon {
            padding: 0 4px 0 12px;
            font-size: 1.1em;
            color: #8E8E93;
            line-height: 0;
        }
        .search-bar {
            width: 100%;
            padding: 8px 15px 8px 5px;
            font-size: 1em;
            border: none;
            background-color: transparent;
            box-sizing: border-box;
            outline: none;
        }
        #safari-history-container {
            display: none;
        }

        /* ===== 음악 앱 ===== */
        #music {
            background: linear-gradient(to bottom, #09203f, #537895); /* Navy to Purple -> Navy to Blueish Gray */
            color: white;
        }
        #music .status-bar,
        #music .app-header,
        #music .content-body {
            background-color: transparent;
        }
        #music .app-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        #music .list-item {
            border-bottom-color: rgba(255, 255, 255, 0.15);
        }
        #music .list-item .preview {
            color: #cccccc;
        }
        #music .list-item .title {
             color: #ffffff;
        }
        
        /* 메모 */
        .note-content { padding: 20px; font-size: 1.1em; line-height: 1.6; white-space: pre-wrap; }
        .lock-icon { margin-right: 8px; }

        /* 일기 (위장) - Sky & Cloud Theme */
        #diary {
            background: linear-gradient(to bottom, #a1c4fd, #c2e9fb); /* Soft sky gradient */
            color: #333;
        }
        #diary .status-bar {
            color: #000;
            background: transparent;
        }
        #diary .app-header {
            background-color: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: #333;
            border-bottom: 1px solid #dcdcdc;
        }
        #diary .content-body {
            background-color: transparent;
            padding: 15px;
        }
        #diary .diary-entry {
            background-color: #ffffff;
            padding: 20px;
            border-bottom: none;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        #diary .diary-entry:last-of-type {
            margin-bottom: 0;
            border-bottom: none;
        }
        #diary .diary-entry .date {
            font-weight: 700;
            color: #888;
            margin-bottom: 8px;
            font-size: 0.9em;
            display: flex;
            align-items: center;
        }
        #diary .diary-entry .date::before {
            content: '☁️';
            margin-right: 8px;
            font-size: 1.1em;
            opacity: 0.8;
        }
        #diary .diary-entry .content {
            line-height: 1.6;
            font-size: 1em;
            color: #333;
        }

        /* 메모 상세 (기존 다크 테마 유지) */
        #note-detail {
            background-color: #121212;
            color: #e0e0e0;
        }
        #note-detail .status-bar {
            color: #ffffff; background: transparent;
        }
        #note-detail .app-header {
            background-color: transparent; color: #e0e0e0; border-bottom: 1px solid #3a3a3a;
        }
        #note-detail .content-body {
            background-color: transparent;
        }

        /* 고양이 케어 다이어리 (Custom App 1) */
        #customApp1 {
            background-color: #121212;
            color: #e0e0e0;
        }
        #customApp1 .status-bar {
            color: #ffffff;
            background: transparent;
        }
        #customApp1 .app-header {
            background-color: transparent;
            color: #e0e0e0;
            font-weight: 500;
            border-bottom: 1px solid #3a3a3a;
            text-shadow: none;
        }
        #customApp1 .content-body {
            background-color: transparent;
            padding: 0;
        }
        #customApp1 .home-indicator-container {
            background-color: transparent;
        }
        #customApp1 .home-indicator {
            background-color: #fff;
        }
        .diary-section {
            margin-bottom: 20px;
        }
        .diary-section-title {
            font-size: 1.2em;
            font-weight: 700;
            color: #e0e0e0;
            padding: 10px 20px;
            background-color: #1c1c1e;
            border-top: 1px solid #3a3a3a;
            border-bottom: 1px solid #3a3a3a;
        }
        #customApp1 .list-item {
            cursor: pointer;
            background-color: #1c1c1e;
            border-bottom: 1px solid #3a3a3a;
        }
        #customApp1 .list-item:hover {
            background-color: #2c2c2e;
        }
        #customApp1 .list-item .title {
            color: #e0e0e0;
            font-weight: normal;
        }
        #customApp1 .list-item .preview {
            color: #888;
        }
        #customApp1 .reminder-checkbox {
            border-color: #888;
        }
        #customApp1 .reminder-checkbox.checked {
            background-color: #34C759;
            border-color: #34C759;
        }
        #customApp1 .reminder-checkbox.checked::after {
            border-color: #121212;
        }
        
        /* ===== 알림 배너 (Notification Banner) ===== */
        .notification-banner {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%) translateY(-150%);
            width: 95%;
            max-width: 380px;
            background-color: rgba(242, 242, 247, 0.85); /* Light theme */
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 9999;
            display: flex;
            align-items: center;
            transition: transform 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
            visibility: hidden;
        }
        .notification-banner.show {
            transform: translateX(-50%) translateY(0);
            visibility: visible;
        }
        .notification-app-icon {
            flex-shrink: 0;
            margin-right: 10px;
        }
        .notification-app-icon img {
            width: 24px;
            height: 24px;
            border-radius: 6px;
        }
        .notification-text-content {
            flex-grow: 1;
        }
        .notification-title {
            font-size: 13px;
            font-weight: 600;
            color: #555; /* Dark gray for light theme */
        }
        .notification-body {
            font-size: 15px;
            color: #000; /* Black text for light theme */
            margin-top: 2px;
        }

        /* ===== Password Modal ===== */
        .modal-overlay {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        .modal-overlay.visible {
            display: flex;
        }
        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 14px;
            width: 270px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.25);
        }
        .modal-content h3 {
            margin: 0 0 8px 0;
            font-size: 1.1em;
            font-weight: 700;
        }
        #password-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            margin: 15px 0;
            box-sizing: border-box;
            text-align: center;
            font-size: 1em;
        }
        .modal-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            border-top: 1px solid #dbdbdb;
            padding-top: 12px;
            margin-top: 5px;
        }
        .modal-buttons button {
            padding: 10px;
            border: none;
            border-radius: 8px;
            background-color: transparent;
            cursor: pointer;
            font-size: 1.05em;
            font-weight: 400;
            color: #007AFF;
        }
        .modal-buttons button#password-submit {
            font-weight: 700;
        }
    </style>
</head>
<body>
    <div class="phone">
        <div class="screen">
            <div id="notification-banner" class="notification-banner">
                <div class="notification-app-icon">
                    <img src="" alt="App Icon">
                </div>
                <div class="notification-text-content">
                    <div class="notification-title"></div>
                    <div class="notification-body"></div>
                </div>
            </div>
            
            <!-- 잠금 화면 -->
            <div id="lock-screen" class="page home-screen active">
                <div class="lock-screen-content">
                    <div id="lock-screen-time"></div>
                    <div id="lock-screen-date"></div>
                </div>
                <div class="unlock-prompt-container">
                    <div id="unlock-prompt">터치하여 잠금해제</div>
                </div>
            </div>

            <!-- 홈 화면 -->
            <div id="home" class="page home-screen">
                <div class="status-bar dark-mode"></div>
                <div class="app-grid">
                    <!-- 기본 앱 -->
                    <div class="app-icon" data-page="calendar"><img src="https://raw.githubusercontent.com/sidsid-hue/sid/4186332fd67b6cfa2470d33bcad0dcad89113e2c/icon/S.webp"><span>캘린더</span></div>
                    <div class="app-icon" data-page="photos"><img src="https://raw.githubusercontent.com/sidsid-hue/sid/4186332fd67b6cfa2470d33bcad0dcad89113e2c/icon/image.webp"><span>사진첩</span></div>
                    <div class="app-icon" data-page="notes"><img src="https://raw.githubusercontent.com/sidsid-hue/sid/4186332fd67b6cfa2470d33bcad0dcad89113e2c/icon/note.webp"><span>메모</span></div>
                    <div class="app-icon" id="diary-app-icon"><img src="https://github.com/sidsid-hue/sid/blob/main/free-icon-diary-207302.png?raw=true"><span>일기</span></div>
                    <div class="app-icon" data-page="reminders"><img src="https://raw.githubusercontent.com/sidsid-hue/sid/4186332fd67b6cfa2470d33bcad0dcad89113e2c/icon/re.webp"><span>미리 알림</span></div>
                    <div class="app-icon" data-page="music"><img src="https://raw.githubusercontent.com/sidsid-hue/sid/4186332fd67b6cfa2470d33bcad0dcad89113e2c/icon/Mu.webp"><span>음악</span></div>
                    <!-- 커스텀 앱 -->
                    <div id="custom-app-icon-1" class="app-icon" data-page="customApp1"></div>
                </div>
                <div class="dock">
                    <div class="app-icon" data-page="calls"><img src="https://raw.githubusercontent.com/sidsid-hue/sid/4186332fd67b6cfa2470d33bcad0dcad89113e2c/icon/Call.webp"></div>
                    <div class="app-icon" data-page="messages"><img src="https://raw.githubusercontent.com/sidsid-hue/sid/4186332fd67b6cfa2470d33bcad0dcad89113e2c/icon/M.webp"></div>
                    <div class="app-icon" data-page="alarms"><img src="https://github.com/sidsid-hue/sid/blob/main/alarm22.png?raw=true"></div>
                    <div class="app-icon" data-page="safari"><img src="https://raw.githubusercontent.com/sidsid-hue/sid/4186332fd67b6cfa2470d33bcad0dcad89113e2c/icon/SA.webp"></div>
                </div>
            </div>

            <!-- 전화 -->
            <div id="calls" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="home">‹</span>
                    최근 통화
                </div>
                <div class="content-body" id="call-history-list"></div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>

            <!-- 알람 -->
            <div id="alarms" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="home">‹</span>
                    알람
                </div>
                <div class="content-body" id="alarm-list"></div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>

            <!-- 캘린더 -->
            <div id="calendar" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="home">‹</span>
                    <span id="calendar-header-title"></span>
                </div>
                <div class="content-body">
                    <!-- Calendar Grid and Event List will be rendered here -->
                </div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>

            <!-- 사진첩 -->
            <div id="photos" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="home">‹</span>
                    최근 항목
                </div>
                <div class="content-body">
                    <div class="section-title">최근 사진</div>
                    <div class="photo-grid" id="recent-photos-grid"></div>
                    <div class="section-title" onclick="toggleSecretPhotos()">비밀 사진</div>
                    <div class="photo-grid" id="secret-photos-grid" style="display: none;"></div>
                </div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>

            <!-- 미리 알림 -->
            <div id="reminders" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="home">‹</span>
                    미리 알림
                </div>
                <div class="content-body" id="reminders-list"></div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>

            <!-- 문자 목록 -->
            <div id="messages" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="home">‹</span>
                    메시지
                </div>
                <div class="content-body" id="message-list"></div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>
            
            <!-- 문자 상세 -->
            <div id="message-detail" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="messages">‹</span>
                    <span id="message-detail-sender"></span>
                </div>
                <div class="content-body">
                    <div class="chat-body" id="message-detail-content"></div>
                </div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>

            <!-- 메모 목록 -->
            <div id="notes" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="home">‹</span>
                    메모
                </div>
                <div class="content-body" id="note-list"></div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>

            <!-- 메모 상세 -->
            <div id="note-detail" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="notes">‹</span>
                    <span id="note-detail-title"></span>
                </div>
                <div class="content-body">
                    <div class="note-content" id="note-detail-content"></div>
                </div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>

            <!-- 사파리 -->
            <div id="safari" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="home">‹</span>
                    <span>Safari</span>
                </div>
                <div class="content-body">
                    <div class="safari-header">
                        <div class="search-bar-container">
                            <span class="search-icon">🔍</span>
                            <input type="text" class="search-bar" placeholder="검색 또는 웹 사이트 이름 입력">
                        </div>
                    </div>
                    <div id="safari-content"></div>
                </div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>

            <!-- 음악 -->
            <div id="music" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="home">‹</span>
                    <span id="music-playlist-title-span"></span>
                </div>
                <div class="content-body" id="music-track-list"></div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>

            <!-- 일기 (위장) -->
            <div id="diary" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="home">‹</span>
                    기록
                </div>
                <div class="content-body" id="diary-list"></div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>

            <!-- 커스텀 앱 1 (고양이 케어 다이어리) -->
            <div id="customApp1" class="page">
                <div class="status-bar"></div>
                <div class="app-header">
                    <span class="back-button" data-page="home">‹</span>
                    <span id="custom-app1-header-title"></span>
                </div>
                <div class="content-body" id="custom-app1-content"></div>
                <div class="home-indicator-container"><div class="home-indicator" data-page="home"></div></div>
            </div>

            <!-- Photo Modal -->
            <div id="photo-modal" class="photo-modal-overlay">
                <span class="close-photo-modal">&times;</span>
                <img class="photo-modal-content" id="modal-image">
            </div>
            
            <!-- Password Modal -->
            <div id="password-modal-overlay" class="modal-overlay">
                <div class="modal-content">
                    <h3>암호를 입력하세요</h3>
                    <input type="password" id="password-input" placeholder="암호">
                    <div class="modal-buttons">
                        <button id="password-cancel">취소</button>
                        <button id="password-submit">확인</button>
                    </div>
                </div>
            </div>

        </div>
    </div>

<script>
const phoneData = {
    callHistory: [
        { name: "아빠", type: "부재중 전화", duration: "" },
        { name: "박진우", type: "발신 통화", duration: "3분 28초" },
        { name: "농구부 주장", type: "수신 통화", duration: "45초" },
        { name: "바이크샵", type: "부재중 전화", duration: "" },
        { name: "엄마", type: "수신 통화", duration: "18초" },
    ],
    alarms: [
        { time: "06:00", label: "아침 운동", enabled: true },
        { time: "08:00", label: "학교. 늦으면 뒤진다.", enabled: true },
        { time: "16:00", label: "농구부 연습", enabled: true },
        { time: "22:00", label: "엔진오일 확인", enabled: false },
    ],
    calendar: {
        month: "6월",
        year: "2025",
        events: [
            { date: 7, title: "까미 집 보수" },
            { date: 13, title: "체육대회" },
            { date: 17, title: "바이크 모임" },
            { date: 20, title: "학교 축제" },
            { date: 30, title: "시험" }
        ]
    },
    photos: {
        recent: [
            "https://github.com/sidsid-hue/sid/blob/main/%EB%AF%BC%ED%98%81/%EB%86%8D%EA%B5%AC.png?raw=true",
            "https://github.com/sidsid-hue/sid/blob/main/%EB%AF%BC%ED%98%81/%EB%AF%BC%EB%93%A4%EB%A0%88.jpg?raw=true",
            "https://github.com/sidsid-hue/sid/blob/main/%EB%AF%BC%ED%98%81/%EC%98%A4%ED%86%A0%EB%B0%94%EC%9D%B4.png?raw=true"
        ],
        secret: [
            "https://github.com/sidsid-hue/sid/blob/main/%EB%AF%BC%ED%98%81/%EA%B9%8C%EB%AF%B8.png?raw=true",
            "https://github.com/sidsid-hue/sid/blob/main/%EB%AF%BC%ED%98%81/%EC%9E%90%ED%95%99.png?raw=true",
        ],
    },
    reminders: [
        { task: "농구화 끈 교체", completed: true },
        { task: "헬멧 쉴드 닦기", completed: true },
        { task: "까미 밥 주기", completed: true },
        { task: "아빠한테 전화", completed: false },
        { task: "교과서 사기", completed: false },
    ],
    messages: [
        {
            id: 1, sender: "아빠", preview: "너 또 오토바이 타고...",
            conversation: [ { type: "received", text: "너 또 오토바이 타고 늦게 들어왔냐. 경찰서에 연락 오기 전에 정신 차려라." }, { type: "sent", text: "ㅇ" }]
        },
        {
            id: 2, sender: "농구부 주장", preview: "내일 아침 6시까지 체육관으로",
            conversation: [ { type: "received", text: "내일 아침 6시까지 체육관으로. 늦지 마라." }, { type: "sent", text: "넵" } ]
        },
        {
            id: 3, sender: "박진우", preview: "야 오늘 PC방 ㄱ?",
            conversation: [ { type: "received", text: "야 오늘 PC방 ㄱ?" }, { type: "sent", text: "ㄴㄴ 바쁨" } ]
        },
        {
            id: 4, sender: "국민은행", preview: "[지출] 12,500원(동네약국)",
            conversation: [
                { type: "received", text: "[국민 체크카드] 05/20 07:20 2,800원(CU편의점) 잔액 145,210원" },
                { type: "received", text: "[국민 체크카드] 05/22 16:45 48,000원(스포츠브랜드) 잔액 97,210원" },
                { type: "received", text: "[국민 체크카드] 05/24 18:20 65,000원(24시동물병원) 잔액 32,210원" },
                { type: "received", text: "[국민 체크카드] 05/27 12:30 16,500원(스포츠 매장) 잔액 15,710원" },
                { type: "received", text: "[국민 체크카드] 06/01 14:20 12,500원(동네약국) 잔액 3,210원" },
            ]
             },
        {
            id: 5, sender: "(광고) XX캐피탈", preview: "최저금리 바이크 할부",
            conversation: [ { type: "received", text: "(광고) XX캐피탈에서 최저금리 바이크 할부 상품이 출시되었습니다." }]
        },
    ],
    notes: [
        { id: 1, type: "secret", title: "여자 꼬시는 법", content: "1. 눈 마주치기 (3초 이상)\n2. 웃어주기 (자연스럽게..ㅅㅂ)\n3. 뭐하냐고 묻기\n4. 칭찬하기? (머리 바꿨네.. 같은 거)\n\n존나 어렵네 진짜" },
        { id: 2, type: "secret", title: "까미에게", content: "까미야, 오늘도 너를 못 데려왔다. 미안해.\n너는 내가 울어도 비웃지 않고, 약해도 싫어하지 않지.\n가끔 너를 안고 있으면 내가 누군지 헷갈려.\n강민혁이 아니라 그냥... 너를 사랑하는 사람.\n아빠가 모르게 용돈 모아서 꼭 병원 데려갈게.\n아프지 마. 제발." },
        { id: 3, type: "normal", title: "바이크 부품", content: "- 엔진 오일 (1000km마다 교체)\n- 브레이크 패드\n- 체인 루브" },
        { id: 4, type: "normal", title: "농구 훈련 메뉴", content: "1. 레이업 슛 100개\n2. 3점슛 50개\n3. 드리블 연습 30분\n4. 체력 훈련 (코트 왕복)" },
        { id: 5, type: "secret", title: "평가", content: "김시환\n-찐따. 근데 부자라서 부럽긴 함... 쫄보인데 돈은 많네\n\n하유성\n-여우새끼. 항상 애들이랑 붙어다니면서 잘난 척. 꼴보기 싫음" },
        { id: 6, type: "normal", title: "강해보이는 법", content: "어깨 펴고 걷기\n눈 마주치면 먼저 안 돌리기\n웃을 때 이빨 보이지 않게\n주머니에 손 넣고 다니기\n싫은 소리 들어도 표정 안 바꾸기\n목소리 낮게 깔고 말하기" },
        { id: 7, type: "normal", title: "까미 정보", content: "뒷골목 길고양이. 이름: 까미.\n치즈맛 간식 좋아함.\n사람 경계하는데 나한텐 안 그럼.\n가끔씩 만지게 해줌." },
        { id: 9, type: "normal", title: "쇼핑 리스트", content: "후드티 (검은색/회색만)\n운동화 (나이키 에어포스)\n고양이 사료 (까미용)\n고양이 간식\n목걸이 (진짜 금으로?)\n단백질 보충제" }
    ],
    safari: {
        recentSearches: ["할리데이비슨 아이언 883", "남자 쿨하게 보이는 법", "농구 드리블 강좌", "허스키한 목소리 만들기"],
        deletedHistory: ["아빠랑 화해하는 법", "소심한 성격 고치는 법", "손 떨릴 때 응급처치"],
    },
    music: {
        playlistTitle: "진짜 나",
        tracks: [
            { title: "걱정말아요 그대", artist: "전인권" },
            { title: "나는 나비", artist: "YB(윤도현밴드)" },
            { title: "너를 위해", artist: "임재범" },
            { title: "겁쟁이", artist: "버즈" },
            { title: "BK Love", artist: "MC 스나이퍼" },
            { title: "예뻤어", artist: "데이식스(DAY6)" },
            { title: "내 고향 서울엔", artist: "검정치마" },
            { title: "하늘을 달리다", artist: "이적" },
            { title: "무릎", artist: "아이유(IU)" },
            { title: "빈차 (Feat. 오혁)", artist: "에픽하이" }
        ]
    },
    diary: [
        { date: "2025-03-05", content: "새학기. 또 그 표정. 아버지는 내가 한심하다는 듯 쳐다봤다. 그 인간 앞에서는 숨도 제대로 못 쉬겠다. 내가 약해 보이면 끝이라고 생각했는데, 사실은 내가 제일 약한 놈이다. 존나 서럽네." },
        { date: "2024-12-15", content: "연습 경기에서 졌다. 마지막에 내가 쏜 슛이 안 들어갔다. 애들은 괜찮다고 했는데 주장 선배 눈빛이 아니었다. 전부 내 탓이다. 집에 오는 길에 오토바이 존나 땡겼다. 사라져버리고 싶다." },
        { date: "2024-03-28", content: "까미를 처음 본 날. 작고 떨고 있는 모습이 예전의 나 같았다. 우유를 줄 때 조심스럽게 다가오는 발걸음이 너무 예뻤다. 이런 마음을 뭐라고 해야 할까? 사랑일까? 까미 앞에서만은 진짜 내가 될 수 있는 것 같다. 부드럽고 따뜻한 내가." },
        { date: "2022-03-28", content: "반 애들이 나를 쫄보라고 놀렸다. 화가 나서 싸웠는데 이겼다. 다들 무서워한다. 이런 기분 처음이야. 강하면 무시당하지 않는구나." },
        { date: "2020-04-02", content: "오늘 학교에서 꽃을 관찰했다. 선생님이 예쁘다고 하셨는데, 나도 그런 게 느껴졌다. 집에 와서 아빠한테 말했더니 '남자가 계집애같이 꽃이나 좋아한다고' 하면서 혼냈다. 왜 예쁜 걸 좋아하면 안 되는 거지? 나는 이상한 건가? 앞으로는 아무한테도 말하지 말아야겠다." },
    ],
    metaMessages: [
        "야. 내 폰 주웠냐.",
        "사례는 한다. 연락해라.",
        "폰 못찾으면 뒤진다 진짜...",
        "광진고 2학년 강민혁.",
        "건들지 말고 정문으로 와라."
    ],
    customApp1: {
        appName: "고양이 케어 다이어리",
        iconUrl: "https://img.icons8.com/ios-filled/100/ffffff/cat-profile.png",
        profileImageUrl: "https://github.com/sidsid-hue/sid/blob/main/pixai-1920545376487663282-2.png?raw=true",
        content: {
            feedingAlarm: { time: "매일 저녁 7시", enabled: true },
            healthCheck: [
                { item: "눈 상태", status: "양호", checked: true },
                { item: "코 (촉촉함)", status: "양호", checked: true },
                { item: "털 상태", status: "확인 필요", checked: false },
                { item: "식욕", status: "왕성함", checked: true },
            ],
            shelterMemos: [
                { condition: "비 오는 날", place: "학교 뒤 공터, 파란색 방수포 밑" },
                { condition: "추운 날", place: "보일러실 환풍구 근처" },
            ],
            memos: [
                { date: "3/28", text: "까미 녀석, 오늘따라 유독 앵긴다. 츄르 사준 걸 아는 건가. 귀찮게 하네 진짜... (근데 좀 귀여웠음)" },
                { date: "4/5", text: "비 존나 오네. 파란 방수포 밑에 잘 있겠지? 내일 아침에 바로 가봐야겠다." },
                { date: "4/8", text: "주장한테 들킬 뻔했다. 학교 뒷골목에서 뭐하냐고 묻길래 담배 핀다고 둘러댔다. 심장 존나 쫄렸네. 까미 놀랐을 듯." }
            ],
            vetInfo: [
                { name: "24시 튼튼 동물병원", address: "광진구 XX로 123" },
                { name: "제일 동물병원", address: "광진구 YY로 45" }
            ],
            shoppingList: [
                { item: "템테이션 치즈맛", purchased: true },
                { item: "고양이용 구충제", purchased: false },
                { item: "따뜻한 담요", purchased: false },
            ]
        }
    }
};

let unlockTarget = null;

function showPage(pageId) {
    document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
    });
    const newPage = document.getElementById(pageId);
    if (newPage) {
        newPage.classList.add('active');
    }
}

function renderCallHistory() {
    const container = document.getElementById('call-history-list');
    container.innerHTML = phoneData.callHistory.map(call => `
        <div class="list-item ${call.type === '부재중 전화' ? 'missed' : ''}">
            <div>
                <div class="title">${call.name}</div>
                <div class="preview">${call.type}</div>
            </div>
            <span>${call.duration}</span>
        </div>
    `).join('');
}

function renderAlarms() {
    const container = document.getElementById('alarm-list');
    container.innerHTML = phoneData.alarms.map(alarm => `
        <div class="list-item">
            <div>
                <div class="title" style="font-size: 1.5em; ${!alarm.enabled ? 'color: #888;' : ''}">${alarm.time}</div>
                <div class="preview" style="${!alarm.enabled ? 'color: #888;' : ''}">${alarm.label}</div>
            </div>
            <div class="alarm-toggle">
                 <label class="toggle-switch">
                    <input type="checkbox" ${alarm.enabled ? 'checked' : ''}>
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    `).join('');
}

function renderCalendar() {
    const calendarData = phoneData.calendar;
    const year = parseInt(calendarData.year);
    const monthName = calendarData.month;
    const month = ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'].indexOf(monthName);

    document.getElementById('calendar-header-title').textContent = `${year}, ${monthName}`;
    const contentBody = document.querySelector('#calendar .content-body');
    contentBody.innerHTML = '';

    const dayNamesContainer = document.createElement('div');
    dayNamesContainer.className = 'day-names';
    dayNamesContainer.innerHTML = ['일', '월', '화', '수', '목', '금', '토'].map(d => `<div>${d}</div>`).join('');
    contentBody.appendChild(dayNamesContainer);

    const grid = document.createElement('div');
    grid.className = 'calendar-grid';

    const firstDayOfMonth = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();

    for (let i = 0; i < firstDayOfMonth; i++) {
        const cell = document.createElement('div');
        cell.className = 'day-cell empty';
        grid.appendChild(cell);
    }

    for (let i = 1; i <= daysInMonth; i++) {
        const cell = document.createElement('div');
        cell.className = 'day-cell';
        cell.innerHTML = `<div class="date-number">${i}</div>`;
        
        const singleEvent = calendarData.events.find(e => e.date === i);
        if (singleEvent) {
            cell.classList.add('has-event');
        }
        grid.appendChild(cell);
    }
    
    const totalCells = firstDayOfMonth + daysInMonth;
    const remainingCells = (7 - (totalCells % 7)) % 7;
    for (let i = 0; i < remainingCells; i++) {
        const cell = document.createElement('div');
        cell.className = 'day-cell empty';
        grid.appendChild(cell);
    }

    contentBody.appendChild(grid);
    
    const eventListContainer = document.createElement('div');
    eventListContainer.className = 'event-list';

    const sortedEvents = [...calendarData.events].sort((a, b) => a.date - b.date);
    const weekdays = ['일', '월', '화', '수', '목', '금', '토'];

    eventListContainer.innerHTML = sortedEvents.map(event => {
        const eventDate = new Date(year, month, event.date);
        const weekday = weekdays[eventDate.getDay()];
        return `
            <div class="event-item">
                <div class="event-date-indicator">
                    <div class="event-date-day">${event.date}</div>
                    <div class="event-date-weekday">${weekday}</div>
                </div>
                <div class="event-title">${event.title}</div>
            </div>
        `;
    }).join('');

    contentBody.appendChild(eventListContainer);
}


function renderPhotos() {
    const recentGrid = document.getElementById('recent-photos-grid');
    recentGrid.innerHTML = phoneData.photos.recent.map(url => `
        <div class="photo-item" onclick="openPhotoModal('${url}')"><img src="${url}" alt="Recent Photo"></div>
    `).join('');

    const secretGrid = document.getElementById('secret-photos-grid');
    secretGrid.innerHTML = phoneData.photos.secret.map(url => `
        <div class="photo-item" onclick="openPhotoModal('${url}')"><img src="${url}" alt="Secret Photo"></div>
    `).join('');
}

window.openPhotoModal = function(imageUrl) {
    const modal = document.getElementById('photo-modal');
    const modalImg = document.getElementById('modal-image');
    if (modal && modalImg) {
        modalImg.src = imageUrl;
        modal.classList.add('visible');
    }
}

function closePhotoModal() {
    const modal = document.getElementById('photo-modal');
    if (modal) {
        modal.classList.remove('visible');
    }
}

window.toggleSecretPhotos = function() {
    const secretGrid = document.getElementById('secret-photos-grid');
    if (secretGrid) {
        const isVisible = secretGrid.style.display === 'grid';
        secretGrid.style.display = isVisible ? 'none' : 'grid';
    }
}

function renderReminders() {
    const container = document.getElementById('reminders-list');
    container.innerHTML = phoneData.reminders.map((r, index) => `
        <div class="list-item" onclick="toggleReminder(${index})">
            <div class="reminder-item">
                <div class="reminder-checkbox ${r.completed ? 'checked' : ''}"></div>
                <span class="title" style="${r.completed ? 'text-decoration: line-through; color: #888;' : ''}">${r.task}</span>
            </div>
        </div>
    `).join('');
}

window.toggleReminder = function(index) {
    if (phoneData.reminders[index]) {
        phoneData.reminders[index].completed = !phoneData.reminders[index].completed;
        renderReminders();
    }
}

function renderMessageList() {
    const container = document.getElementById('message-list');
    container.innerHTML = phoneData.messages.map(msg => `
        <div class="list-item" onclick="showMessageDetail(${msg.id})">
            <div>
                <div class="title">${msg.sender}</div>
                <div class="preview">${msg.preview}</div>
            </div>
            <span>›</span>
        </div>
    `).join('');
}

window.showMessageDetail = function(id) {
    const messageData = phoneData.messages.find(msg => msg.id === id);
    if (!messageData) return;

    document.getElementById('message-detail-sender').textContent = messageData.sender;
    const container = document.getElementById('message-detail-content');
    container.innerHTML = messageData.conversation.map(chat => `
        <div class="message-bubble ${chat.type}">${chat.text}</div>
    `).join('');
    showPage('message-detail');
}

function showPasswordPrompt() {
    const modal = document.getElementById('password-modal-overlay');
    modal.classList.add('visible');
    const input = document.getElementById('password-input');
    input.value = '';
    input.focus();
}

function hidePasswordPrompt() {
    const modal = document.getElementById('password-modal-overlay');
    modal.classList.remove('visible');
    unlockTarget = null;
}

function handleNoteClick(noteId) {
    const noteData = phoneData.notes.find(note => note.id === noteId);
    if (!noteData) {
        console.error("Note not found:", noteId);
        return;
    }

    if (noteData.type === 'secret') {
        unlockTarget = noteId;
        showPasswordPrompt();
    } else {
        showNoteDetail(noteId);
    }
}

function handleDiaryClick() {
    unlockTarget = 'diary';
    showPasswordPrompt();
}

function renderNoteList() {
    const container = document.getElementById('note-list');
    const sortedNotes = [...phoneData.notes].sort((a, b) => {
        if (a.type === 'secret' && b.type !== 'secret') return -1;
        if (a.type !== 'secret' && b.type === 'secret') return 1;
        return a.id - b.id;
    });

    container.innerHTML = sortedNotes.map(note => {
        const preview = note.type === 'secret' ? '비밀 메모입니다.' : (note.content.substring(0, 30) + '...');
        return `
            <div class="list-item" data-note-id="${note.id}">
                <div>
                    <div class="title">${note.type === 'secret' ? '<span class="lock-icon">🔒</span>' : ''}${note.title}</div>
                    <div class="preview">${preview}</div>
                </div>
                <span>›</span>
            </div>
        `;
    }).join('');
}


function showNoteDetail(id) {
    const noteData = phoneData.notes.find(note => note.id === id);
    if (!noteData) {
        return; // Note not found
    }
    document.getElementById('note-detail-title').textContent = noteData.title;
    document.getElementById('note-detail-content').innerHTML = noteData.content;
    showPage('note-detail');
}

function renderSafariHistory() {
    const container = document.getElementById('safari-content');
    let html = '<div id="safari-history-container">';
    html += '<div class="section-title">최근 검색어</div>';
    html += phoneData.safari.recentSearches.map(term => `<div class="list-item"><div>${term}</div></div>`).join('');
    html += '<div class="section-title" onclick="toggleDeletedHistory()">삭제한 기록</div>';
    html += '<div id="deleted-history-list" style="display: none;">';
    html += phoneData.safari.deletedHistory.map(term => `<div class="list-item"><div style="color: #888;">${term}</div></div>`).join('');
    html += '</div>';
    html += '</div>';
    container.innerHTML = html;
}

window.toggleDeletedHistory = function() {
    const list = document.getElementById('deleted-history-list');
    if (list) {
        const isVisible = list.style.display === 'block';
        list.style.display = isVisible ? 'none' : 'block';
    }
}

function renderMusicPlaylist() {
    document.getElementById('music-playlist-title-span').textContent = phoneData.music.playlistTitle;
    const container = document.getElementById('music-track-list');
    container.innerHTML = phoneData.music.tracks.map(track => `
        <div class="list-item">
            <div>
                <div class="title">${track.title}</div>
                <div class="preview">${track.artist}</div>
            </div>
        </div>
    `).join('');
}

function renderDiary() {
    const container = document.getElementById('diary-list');
    container.innerHTML = phoneData.diary.slice().reverse().map(entry => `
        <div class="diary-entry">
            <div class="date">${entry.date}</div>
            <div class="content">${entry.content}</div>
        </div>
    `).join('');
}

window.toggleCatFeedingAlarm = function() {
    const alarm = phoneData.customApp1.content.feedingAlarm;
    if (alarm) {
        alarm.enabled = !alarm.enabled;
        renderCustomApp1();
    }
};

window.toggleCatHealthCheck = function(index) {
    const healthCheckItem = phoneData.customApp1.content.healthCheck[index];
    if (healthCheckItem) {
        healthCheckItem.checked = !healthCheckItem.checked;
        renderCustomApp1();
    }
};

window.toggleShoppingListItem = function(index) {
    const shoppingListItem = phoneData.customApp1.content.shoppingList[index];
    if (shoppingListItem) {
        shoppingListItem.purchased = !shoppingListItem.purchased;
        renderCustomApp1();
    }
};

function renderCustomApp1() {
    const appData = phoneData.customApp1;
    document.getElementById('custom-app1-header-title').textContent = appData.appName;
    const container = document.getElementById('custom-app1-content');
    
    const content = appData.content;
    
    let html = '';

    if (appData.profileImageUrl) {
        html += `
            <div style="padding: 20px 20px 10px; text-align: center;">
                <img src="${appData.profileImageUrl}" alt="까미 프로필 사진" style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 3px solid #4a4a4a;">
                <h2 style="font-size: 1.4em; font-weight: 500; margin: 12px 0 0; color: #f0f0f0;">까미</h2>
            </div>
        `;
    }
    
    html += `
        <div class="diary-section">
            <div class="diary-section-title">밥주기 알람</div>
            <div class="list-item" onclick="toggleCatFeedingAlarm()">
                <div>
                    <div class="title" style="font-size: 1.2em; ${!content.feedingAlarm.enabled ? 'color: #888;' : ''}">${content.feedingAlarm.time}</div>
                </div>
                <div class="alarm-toggle">
                     <label class="toggle-switch">
                        <input type="checkbox" ${content.feedingAlarm.enabled ? 'checked' : ''}>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
        </div>

        <div class="diary-section">
            <div class="diary-section-title">까미 건강 체크</div>
            ${content.healthCheck.map((item, index) => `
                <div class="list-item" onclick="toggleCatHealthCheck(${index})">
                    <div class="reminder-item">
                        <div class="reminder-checkbox ${item.checked ? 'checked' : ''}"></div>
                        <span class="title">${item.item}</span>
                    </div>
                    <span style="color: #888;">${item.status}</span>
                </div>
            `).join('')}
        </div>
        
        <div class="diary-section">
            <div class="diary-section-title">날씨별 보호 장소</div>
            ${content.shelterMemos.map(memo => `
                <div class="list-item" style="cursor: default;">
                    <div>
                        <div class="title">${memo.condition}</div>
                        <div class="preview">${memo.place}</div>
                    </div>
                </div>
            `).join('')}
        </div>
        
        <div class="diary-section">
            <div class="diary-section-title">까미 관찰 메모</div>
            ${content.memos.map(memo => `
                <div class="list-item" style="cursor: default; display: block;">
                    <div style="font-size: 0.9em; color: #888; margin-bottom: 5px;">${memo.date}</div>
                    <div class="title" style="white-space: normal; line-height: 1.4;">${memo.text}</div>
                </div>
            `).join('')}
        </div>

        <div class="diary-section">
            <div class="diary-section-title">주변 동물병원</div>
             ${content.vetInfo.map(vet => `
                <div class="list-item" style="cursor: default;">
                    <div>
                        <div class="title">${vet.name}</div>
                        <div class="preview">${vet.address}</div>
                    </div>
                </div>
            `).join('')}
        </div>

        <div class="diary-section">
            <div class="diary-section-title">구매 목록</div>
            ${content.shoppingList.map((item, index) => `
                <div class="list-item" onclick="toggleShoppingListItem(${index})">
                    <div class="reminder-item">
                        <div class="reminder-checkbox ${item.purchased ? 'checked' : ''}"></div>
                        <span class="title" style="${item.purchased ? 'text-decoration: line-through; color: #888;' : ''}">${item.item}</span>
                    </div>
                </div>
            `).join('')}
        </div>
    `;

    container.innerHTML = html;

    const iconContainer = document.getElementById('custom-app-icon-1');
    iconContainer.innerHTML = `<img src="${appData.iconUrl}" style="background-color: #333; border-radius: 15px;"><span>${appData.appName}</span>`;
}

function startMetaMessageSequence() {
    const banner = document.getElementById('notification-banner');
    const bannerBody = banner.querySelector('.notification-body');
    const bannerTitle = banner.querySelector('.notification-title');
    const bannerIcon = banner.querySelector('.notification-app-icon img');
    if (!banner || !bannerBody) return;

    let messageIndex = 0;

    const showNextMessage = () => {
        if (messageIndex >= phoneData.metaMessages.length) {
            return; 
        }
        
        bannerTitle.textContent = "메시지";
        bannerIcon.src = "https://raw.githubusercontent.com/sidsid-hue/sid/4186332fd67b6cfa2470d33bcad0dcad89113e2c/icon/M.webp";
        bannerBody.textContent = phoneData.metaMessages[messageIndex];
        banner.classList.add('show');

        setTimeout(() => {
            banner.classList.remove('show');
            messageIndex++;
            setTimeout(showNextMessage, 1500);
        }, 3000);
    };
    
    setTimeout(showNextMessage, 30000);
}


// Initial Render
document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.home-screen').forEach(screen => {
        screen.style.backgroundImage = `url('https://github.com/sidsid-hue/sid/blob/main/cafe-racer-5800084_1280.jpg?raw=true')`;
    });
    
    const simulatedStartTime = new Date(2025, 5, 2, 8, 40, 0); // June 2, 2025, 8:40 AM
    const pageLoadTime = Date.now();

    function updateClock() {
        const elapsedMilliseconds = Date.now() - pageLoadTime;
        const now = new Date(simulatedStartTime.getTime() + elapsedMilliseconds);
        const fixedDate = new Date(2025, 5, 2); // Month is 0-indexed, so 5 is June.

        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const timeString = `${hours}:${minutes}`;
        
        document.querySelectorAll('.status-bar').forEach(bar => {
            bar.textContent = timeString;
        });

        const lockScreenTime = document.getElementById('lock-screen-time');
        const lockScreenDate = document.getElementById('lock-screen-date');
        if (lockScreenTime) {
            lockScreenTime.textContent = timeString;
        }
        if (lockScreenDate) {
            const days = ['일요일', '월요일', '화요일', '수요일', '목요일', '금요일', '토요일'];
            const dateString = `${fixedDate.getMonth() + 1}월 ${fixedDate.getDate()}일 ${days[fixedDate.getDay()]}`;
            lockScreenDate.textContent = dateString;
        }
    }

    updateClock();
    setInterval(updateClock, 1000);

    const lockScreen = document.getElementById('lock-screen');
    if (lockScreen) {
        lockScreen.addEventListener('click', () => {
            showPage('home');
        });
    }
    
    document.querySelectorAll('[data-page]').forEach(el => {
        el.addEventListener('click', (e) => {
            if (e.target.classList.contains('back-button')) {
                 e.stopPropagation();
            }
            showPage(el.dataset.page);
        });
    });

    const diaryIcon = document.getElementById('diary-app-icon');
    if(diaryIcon) {
        diaryIcon.addEventListener('click', handleDiaryClick);
    }

    renderCallHistory();
    renderAlarms();
    renderCalendar();
    renderPhotos();
    renderReminders();
    renderMessageList();
    renderNoteList();
    renderSafariHistory();
    renderMusicPlaylist();
    renderDiary();
    renderCustomApp1();

    const noteListContainer = document.getElementById('note-list');
    if (noteListContainer) {
        noteListContainer.addEventListener('click', (event) => {
            const noteItem = event.target.closest('.list-item[data-note-id]');
            if (noteItem) {
                const noteId = parseInt(noteItem.dataset.noteId, 10);
                if (!isNaN(noteId)) {
                    handleNoteClick(noteId);
                }
            }
        });
    }
    
    const photoModal = document.getElementById('photo-modal');
    const closePhotoBtn = document.querySelector('.close-photo-modal');
    if (closePhotoBtn) {
        closePhotoBtn.addEventListener('click', closePhotoModal);
    }
    if (photoModal) {
        photoModal.addEventListener('click', (event) => {
            if (event.target === photoModal) {
                closePhotoModal();
            }
        });
    }

    const passwordSubmitBtn = document.getElementById('password-submit');
    const passwordCancelBtn = document.getElementById('password-cancel');
    const passwordModalOverlay = document.getElementById('password-modal-overlay');

    passwordSubmitBtn.addEventListener('click', () => {
        const password = document.getElementById('password-input').value;
        if (password === "0410") {
            if (typeof unlockTarget === 'number') {
                showNoteDetail(unlockTarget);
            } else if (unlockTarget === 'diary') {
                showPage('diary');
            } else if (unlockTarget === 'secretPhotos') {
                const secretGrid = document.getElementById('secret-photos-grid');
                if (secretGrid) {
                    secretGrid.style.display = 'grid';
                }
            }
            hidePasswordPrompt();
        } else {
            alert("암호가 틀렸습니다.");
            const input = document.getElementById('password-input');
            input.value = '';
            input.focus();
        }
    });

    passwordCancelBtn.addEventListener('click', hidePasswordPrompt);
    passwordModalOverlay.addEventListener('click', (event) => {
        if (event.target === passwordModalOverlay) {
            hidePasswordPrompt();
        }
    });


    const safariSearchBar = document.querySelector('#safari .search-bar');
    if (safariSearchBar) {
        safariSearchBar.addEventListener('focus', () => {
            const historyContainer = document.getElementById('safari-history-container');
            if (historyContainer) {
                historyContainer.style.display = 'block';
            }
        });
    }

    startMetaMessageSequence();
});

</script>
</body>
</html>
